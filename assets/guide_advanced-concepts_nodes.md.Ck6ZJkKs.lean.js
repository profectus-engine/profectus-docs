import{_ as i,c as a,a0 as n,o as t}from"./chunks/framework.P9qPzDnn.js";const d=JSON.parse('{"title":"Nodes","description":"","frontmatter":{},"headers":[],"relativePath":"guide/advanced-concepts/nodes.md","filePath":"guide/advanced-concepts/nodes.md","lastUpdated":1737059031000}'),h={name:"guide/advanced-concepts/nodes.md"};function e(k,s,l,p,D,F){return t(),a("div",null,s[0]||(s[0]=[n(`<h1 id="nodes" tabindex="-1">Nodes <a class="header-anchor" href="#nodes" aria-label="Permalink to &quot;Nodes&quot;">â€‹</a></h1><p>Features rendered in the DOM should include a <code>Node</code> component, which registers itself to the nearest <code>Context</code> component (usually within the <code>Layer</code>&#39;s component) and tracks the bounding rect (both size and position) of the DOM element. Access the DOM element for a feature via its unique <code>id</code> property within <code>layer.nodes</code>, provided it currently exists.</p><p>This is useful for features with complex displays, such as particle effects positioned relative to another feature or drawing links between different nodes. To illustrate this, let&#39;s look at a complete example of using <code>layer.nodes</code> to get a node&#39;s bounding rect and then placing a particle effect using it. Here&#39;s an example from Kronos:</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes material-theme-palenight material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">const</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> particlesEmitter </span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;"> ref</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">(particles</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;">addEmitter</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">(element</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">particlesConfig))</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">const</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> updateParticleEffect </span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">=</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> async</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> ([shouldEmit</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> rect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> boundingRect]</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">:</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> [</span></span>
<span class="line"><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">    boolean</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">    DOMRect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> undefined</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;">    DOMRect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> |</span><span style="--shiki-light:#FFCB6B;--shiki-dark:#FFCB6B;"> undefined</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">]) </span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">=&gt;</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;">    const</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> emitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;"> await</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> particlesEmitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">value</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">    emitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">emit</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> =</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> isGaining</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> &amp;&amp;</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> rect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> !=</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> undefined</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> &amp;&amp;</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> boundingRect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> !=</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> undefined;</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-light-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic;">    if</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;"> (</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">emitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">emit</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> &amp;&amp;</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> !</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">emitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">destroyed</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">) </span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">{</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">        emitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;">cleanup</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">()</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">        emitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;">updateOwnerPos</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">(</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">            rect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">x</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> +</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> rect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">width</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> /</span><span style="--shiki-light:#F78C6C;--shiki-dark:#F78C6C;"> 2</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> -</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> boundingRect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">x</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">            rect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">y</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> +</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> rect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">height</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> /</span><span style="--shiki-light:#F78C6C;--shiki-dark:#F78C6C;"> 2</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;"> -</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> boundingRect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">y</span></span>
<span class="line"><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">        )</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">        emitter</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;">resetPositionTracking</span><span style="--shiki-light:#F07178;--shiki-dark:#F07178;">()</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">;</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">    }</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">};</span></span>
<span class="line"><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;">watch</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">(</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">    [</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">        ()</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> Decimal</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#82AAFF;--shiki-dark:#82AAFF;">gt</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">(actualGain</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">value</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span><span style="--shiki-light:#F78C6C;--shiki-dark:#F78C6C;"> 0</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">)</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">        ()</span><span style="--shiki-light:#C792EA;--shiki-dark:#C792EA;"> =&gt;</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;"> layer</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">nodes</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">value[name]</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">?.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">rect</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">        particles</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">.</span><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">boundingRect</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">    ]</span><span style="--shiki-light:#89DDFF;--shiki-dark:#89DDFF;">,</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">    updateParticleEffect</span></span>
<span class="line"><span style="--shiki-light:#BABED8;--shiki-dark:#BABED8;">)</span></span></code></pre></div><p>In this example the particle effects will update whenever the window resizes, the feature&#39;s bounding rect changes, or the particle effect is supposed to turn on/off. By watching for other relevant properties you can ensure even more complex situations are accounted for.</p><p>The bounding rect is usually kept up-to-date and responsive to changes such as nodes resizing, moving due to window resizing, or features being shown or hidden. However, occasional situations may cause it to be out of sync. Therefore, it&#39;s recommended to use the node system for visual effects only, where any glitches have minimal impact.</p>`,6)]))}const B=i(h,[["render",e]]);export{d as __pageData,B as default};
